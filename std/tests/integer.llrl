(import "std/integer" _)
(println! "std/tests/integer")

(import "std/tests/ord" [ord/_ _])
(import "std/tests/arithmetic" [arithmetic/_ _])

(assert-eq? 123 {I8} 123)
(assert-eq? 65535 {U16} 65535)
(assert-eq? -100 {I32} -100)
(assert-ne? -100 {I32} 100)
(assert-eq? 12345678901234567890 {U64} 12345678901234567890)

(assert-eq? 0 default)

(ord/test123 -100 {I8} 0 100)
(ord/test123 0 {U16} 10000 60000)
(ord/test123 -1 {I32} 0 1)
(ord/test123 1 {U64} 100 10000)

(arithmetic/test-signed 0 {I8})
(arithmetic/test-signed 0 {I16})
(arithmetic/test-signed 0 {I32})
(arithmetic/test-signed 0 {I64})
(arithmetic/test-unsigned 0 {U8})
(arithmetic/test-unsigned 0 {U16})
(arithmetic/test-unsigned 0 {U32})
(arithmetic/test-unsigned 0 {U64})

; Large numbers
(assert-eq? 0 (+ 255 {U8} 1))
(assert-eq? (+ 12288 4096) 16384 {I16})
(assert-eq? (- 4096 12288) -8192 {I16})
(assert-eq? (* 6144 -5) -30720 {I16})
(assert-eq? (* 5 -6144) -30720 {I16})
(assert-eq? (/ 12288 -5) -2457 {I16})
(assert-eq? 65534 (- 10 {U16} 12))
(assert-eq? (+ 12288 4096) 16384 {U16})
(assert-eq? (- 12288 4096) 8192 {U16})
(assert-eq? (* 12288 5) 61440 {U16})
(assert-eq? (* 5 12288) 61440 {U16})
(assert-eq? (/ 12288 5) 2457 {U16})
(assert-eq? (+ 536870912 536870923) 1073741835 {I32})
(assert-eq? (- 1048576 1073741814) -1072693238 {I32})
(assert-eq? (* 16777216 -11) -184549376 {I32})
(assert-eq? (* -11 16777216) -184549376 {I32})
(assert-eq? (/ 536870912 -11) -48806446 {I32})
(assert-eq? (+ 1073741824 1073741834) 2147483658 {U32})
(assert-eq? (- 1073741824 536870922) 536870902 {U32})
(assert-eq? (* 536870912 5) 2684354560 {U32})
(assert-eq? (* 5 536870912) 2684354560 {U32})
(assert-eq? (/ 2684354560 524288) 5120 {U32})
(assert-eq? (+ 1099511627776 -4398046511104) -3298534883328 {I64})
(assert-eq? (- -1099511627776 4398046511104) -5497558138880 {I64})
(assert-eq? (* -1099511627776 -1025) 1126999418470400 {I64})
(assert-eq? (* 1025 -1099511627776) -1126999418470400 {I64})
(assert-eq? (/ 140737488355328 -2199023255552) -64 {I64})
(assert-eq? (+ 1125899906842624 9007199254740992) 10133099161583616 {U64})
(assert-eq? (- 18446744073709551606 1152921504606846976) 17293822569102704630 {U64})
(assert-eq? (* 137438965817 67115653) 9224305938452633501 {U64})
(assert-eq? (* 67115653 137438965817) 9224305938452633501 {U64})
(assert-eq? (/ 137438965817 2) 68719482908 {U64})

(assert-eq? "0" (string 0 {I8}))
(assert-eq? "0" (string 0 {U16}))
(assert-eq? "153" (string 153 {I32}))
(assert-eq? "153" (string 153 {U64}))
(assert-eq? "200" (string 200 {U8}))
(assert-eq? "-30001" (string -30001 {I16}))
(assert-eq? "9" (string 9 {U32}))
(assert-eq? "-8" (string -8 {I64}))

(assert-eq? none {(Option I32)} (integer/from-string? 10 ""))
(assert-eq? (some 0) {(Option I32)} (integer/from-string? 10 "0"))
(assert-eq? (some 9015) {(Option I32)} (integer/from-string? 10 "9015"))
(assert-eq? (some -634) {(Option I32)} (integer/from-string? 10 "-634"))
(assert-eq? none {(Option I32)} (integer/from-string? 10 "xyz"))
(assert-eq? (some 128) {(Option U8)} (integer/from-string? 10 "128"))
(assert-eq? (some 128) {(Option I16)} (integer/from-string? 10 "128"))
(assert-eq? none {(Option I8)} (integer/from-string? 10 "128"))
(assert-eq? none {(Option U8)} (integer/from-string? 10 "-130"))
(assert-eq? none {(Option I8)} (integer/from-string? 10 "-130"))
(assert-eq? none {(Option U16)} (integer/from-string? 10 "-130"))
(assert-eq? (some -130) {(Option I16)} (integer/from-string? 10 "-130"))
(assert-eq? (some -9223372036854775808) {(Option I64)} (integer/from-string? 10 "-9223372036854775808"))
(assert-eq? (some 9223372036854775807) {(Option I64)} (integer/from-string? 10 "9223372036854775807"))
(assert-eq? (some 18446744073709551615) {(Option U64)} (integer/from-string? 10 "18446744073709551615"))
(assert-eq? none {(Option I64)} (integer/from-string? 10 "-9223372036854775809"))
(assert-eq? none {(Option I64)} (integer/from-string? 10 "9223372036854775808"))
(assert-eq? none {(Option U64)} (integer/from-string? 10 "18446744073709551616"))
