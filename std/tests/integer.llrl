(import "std/integer" _)
(import "std/tests/ord" [ord/_ _])
(import "std/tests/arithmetic" [arithmetic/_ _])

(assert-eq? 123 {I8} 123)
(assert-eq? 65535 {U16} 65535)
(assert-eq? -100 {I32} -100)
(assert-ne? -100 {I32} 100)
(assert-eq? 12345678901234567890 {U64} 12345678901234567890)

(assert-eq? 0 default)

(ord/test123 -100 {I8} 0 100)
(ord/test123 0 {U16} 10000 60000)
(ord/test123 -1 {I32} 0 1)
(ord/test123 1 {U64} 100 10000)

(arithmetic/test-signed 0 {I8})
(arithmetic/test-signed 0 {I16})
(arithmetic/test-signed 0 {I32})
(arithmetic/test-signed 0 {I64})
(arithmetic/test-unsigned 0 {U8})
(arithmetic/test-unsigned 0 {U16})
(arithmetic/test-unsigned 0 {U32})
(arithmetic/test-unsigned 0 {U64})

; Unsigned integers are wrapping by default
(assert-eq? 0 (+ 255 {U8} 1))
(assert-eq? 65534 (- 10 {U16} 12))

(assert-eq? "0" (string 0 {I8}))
(assert-eq? "0" (string 0 {U16}))
(assert-eq? "153" (string 153 {I32}))
(assert-eq? "153" (string 153 {U64}))
(assert-eq? "200" (string 200 {U8}))
(assert-eq? "-30001" (string -30001 {I16}))
(assert-eq? "9" (string 9 {U32}))
(assert-eq? "-8" (string -8 {I64}))

(assert-eq? none {(Option I32)} (integer/from-string? 10 ""))
(assert-eq? (some 0) {(Option I32)} (integer/from-string? 10 "0"))
(assert-eq? (some 9015) {(Option I32)} (integer/from-string? 10 "9015"))
(assert-eq? (some -634) {(Option I32)} (integer/from-string? 10 "-634"))
(assert-eq? none {(Option I32)} (integer/from-string? 10 "xyz"))
(assert-eq? (some 128) {(Option U8)} (integer/from-string? 10 "128"))
(assert-eq? (some 128) {(Option I16)} (integer/from-string? 10 "128"))
(assert-eq? none {(Option I8)} (integer/from-string? 10 "128"))
(assert-eq? none {(Option U8)} (integer/from-string? 10 "-130"))
(assert-eq? none {(Option I8)} (integer/from-string? 10 "-130"))
(assert-eq? none {(Option U16)} (integer/from-string? 10 "-130"))
(assert-eq? (some -130) {(Option I16)} (integer/from-string? 10 "-130"))
(assert-eq? (some -9223372036854775808) {(Option I64)} (integer/from-string? 10 "-9223372036854775808"))
(assert-eq? (some 9223372036854775807) {(Option I64)} (integer/from-string? 10 "9223372036854775807"))
(assert-eq? (some 18446744073709551615) {(Option U64)} (integer/from-string? 10 "18446744073709551615"))
(assert-eq? none {(Option I64)} (integer/from-string? 10 "-9223372036854775809"))
(assert-eq? none {(Option I64)} (integer/from-string? 10 "9223372036854775808"))
(assert-eq? none {(Option U64)} (integer/from-string? 10 "18446744073709551616"))
